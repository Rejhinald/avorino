<script>
window.AV=window.AV||{};
window.AV.hero=function(delay){
// Set initial states (gsap is loaded by the time footer calls this)
var nav=document.querySelector('.site-nav')||document.querySelector('.nav');
var hImg=document.querySelector('.hero-image');
if(nav)gsap.set(nav,{opacity:0});
if(hImg)gsap.set(hImg,{clipPath:'inset(6%)',scale:1.25});

function splitHeroTitle(el){
var all=[];
function go(node,parent){
if(node.nodeType===3){
var t=node.textContent.replace(/\s*\n\s*/g,' ').replace(/\s{2,}/g,' ');
if(!t.trim()){parent.removeChild(node);return}
var f=document.createDocumentFragment();
t.split(/(\s+)/).forEach(function(w){
if(/^\s+$/.test(w)){var s=document.createElement('span');s.classList.add('char');s.style.display='inline-block';s.innerHTML='&nbsp;';s.style.opacity='0';s.style.transform='translateY(60px) rotateX(-90deg)';s.style.filter='blur(4px)';f.appendChild(s);all.push(s)}
else if(w){var ww=document.createElement('span');ww.style.whiteSpace='nowrap';ww.style.display='inline';for(var i=0;i<w.length;i++){var s=document.createElement('span');s.classList.add('char');s.style.display='inline-block';s.style.opacity='0';s.style.transform='translateY(60px) rotateX(-90deg)';s.style.filter='blur(4px)';s.textContent=w[i];ww.appendChild(s);all.push(s)}f.appendChild(ww)}
});parent.insertBefore(f,node);parent.removeChild(node)}
else if(node.nodeName!=='BR'){Array.from(node.childNodes).forEach(function(c){go(c,node)})}
}
Array.from(el.childNodes).forEach(function(c){go(c,el)});return all}

var hT=document.querySelector('.hero-title');
var hS=document.querySelector('.hero-subtitle');

var tl=gsap.timeline({delay:delay||0});
if(hImg)tl.to(hImg,{clipPath:'inset(0%)',scale:1,duration:1.8,ease:'power4.inOut'},0);
if(hT){var tc=splitHeroTitle(hT);tl.to(tc,{opacity:1,y:0,rotateX:0,filter:'blur(0px)',duration:1.2,stagger:.025,ease:'power4.out'},.6)}
if(hS)tl.from(hS,{opacity:0,y:20,duration:.8,ease:'power3.out'},'-=0.6');
if(nav)tl.to(nav,{opacity:1,duration:.6,ease:'power3.out'},'-=0.4');
};
</script>
