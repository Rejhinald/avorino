<script>
window.AV=window.AV||{};
window.AV.services=function(){
var section=document.querySelector('.services');
var track=document.querySelector('.services-track');
var progressBar=document.querySelector('.services-progress-bar');
var counter=document.querySelector('.services-counter');
if(!section||!track)return;

var cards=track.querySelectorAll('.service-card');
var totalCards=cards.length;
if(totalCards===0)return;

cards.forEach(function(card){card.style.flexShrink='0'});

function setTrackWidth(){
var totalWidth=0;
cards.forEach(function(card){totalWidth+=card.offsetWidth});
var gap=parseFloat(getComputedStyle(track).gap)||32;
totalWidth+=(totalCards-1)*gap;
var cs=getComputedStyle(track);
totalWidth+=parseFloat(cs.paddingLeft)+parseFloat(cs.paddingRight);
track.style.width=totalWidth+'px';
}
setTrackWidth();

var getScrollAmount=function(){return Math.max(track.scrollWidth-window.innerWidth,0)};

gsap.to(track,{
x:function(){return -getScrollAmount()},
ease:'none',
scrollTrigger:{
trigger:section,
pin:true,
anticipatePin:1,
start:'top top',
end:function(){return '+='+(getScrollAmount()*1.2)},
scrub:1,
invalidateOnRefresh:true,
onRefreshInit:setTrackWidth,
onUpdate:function(self){
if(progressBar)gsap.set(progressBar,{scaleX:self.progress});
if(counter&&totalCards>0){
var currentCard=Math.min(Math.floor(self.progress*totalCards)+1,totalCards);
counter.textContent=String(currentCard).padStart(2,'0')+' / '+String(totalCards).padStart(2,'0');
}
}
}
});

setTimeout(function(){ScrollTrigger.refresh()},200);
};
</script>
